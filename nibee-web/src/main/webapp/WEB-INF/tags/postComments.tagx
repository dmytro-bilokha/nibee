<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:fmt="http://java.sun.com/jsp/jstl/fmt"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:cnt="urn:jsptagdir:/WEB-INF/tags/"
    version="2.1">

    <jsp:directive.tag pageEncoding="UTF-8"/>
    <jsp:directive.attribute name="model" required="true" type="com.dmytrobilokha.nibee.web.comment.CommentsModel"/>

    <c:set var="leftDepthMarginMax" value="${15}"/>
    <div id="commentsBlock">
        <c:forEach items="${model.comments}" var="comment">
            <c:set var="leftDepthMargin" value="${comment.depthLevel * 1.5}"/>
            <c:if test="${leftDepthMargin gt leftDepthMarginMax}">
                <c:set var="leftDepthMargin" value="${leftDepthMarginMax}"/>
            </c:if>
            <div id="comment-${comment.id}" style="margin-left: ${leftDepthMargin}em;">
                <h6>
                    <c:out value="${comment.authorNickname}"/> commented <c:out value="${comment.createdOn}"/>
                    <button class="replyToCommentButton" id="replyButton-${comment.id}" disabled="true">Reply</button>
                </h6>
                <pre><c:out value="${comment.content}"/></pre>
            </div>
        </c:forEach>
        <cnt:newCommentForm postId="${model.postId}"/>
    </div>

</jsp:root>
